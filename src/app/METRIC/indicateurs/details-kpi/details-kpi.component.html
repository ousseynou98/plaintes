<div class="row black-card">
  <div class="col-md-8 text-left">
    <nav style="--bs-breadcrumb-divider: '>'" aria-label="dark breadcrumb">
      <ol class="breadcrumb breadcrumb-dark">
        <li class="breadcrumb-item"><a href="metric">METRIC</a></li>
        <li class="breadcrumb-item">
          <a routerLink="/metric/indicateurs">Indicateurs</a>
        </li>
        <li class="breadcrumb-item active text-white" aria-current="page">
          {{ indicateurDetail.name }}
        </li>
      </ol>
    </nav>
  </div>
  <div class="col-md-4 text-right">
    <button
      [hidden]="views[0].bool"
      class="btn btn-outline-primary"
      data-toggle="modal"
      data-target="#mensualiserObjectifModal"
    >
      <span><i class="material-icons">edit</i>Mensualisation</span>
    </button>
  </div>
</div>

<div class="container-fluid">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header card-header-icon card-header-warning">
        <div class="card-icon">
          <i class="material-icons">assignment</i>
        </div>
        <div class="col-sm-2 mr-auto ml-auto">
          <h4 class="text-primary text-center">Indicateur</h4>
        </div>
        <div class="card-title">
          <div class="row col-md-12 mr-auto ml-auto">
            <div class="col-sm-8 mr-auto ml-auto">
              <h3 class="text-center font-weight-bold">
                {{ indicateurDetail.name }}
              </h3>
              <h4
                class="text-center font-weight-bold"
                style="color: red"
                *ngIf="indicateurDetail.arret"
              >
                Cet indicateur a été désactivé le
                {{ indicateurDetail.dateArret | date : "dd/MM/yyyy" }}
              </h4>
            </div>
          </div>
        </div>
      </div>
      <div class="card-body">
        <div class="tab-content tab-space tab-subcategories">
          <div class="tab-pane active">
            <div class="card col-md-12">
              <div class="card-body col-md-12 ml-auto mr-auto">
                <div class="page-categories">
                  <ul
                    class="nav nav-pills nav-pills-warning nav-pills-icons justify-content-center"
                    role="tablist"
                  >
                    <li class="nav-item col-md-2">
                      <a
                        class="nav-link"
                        data-toggle="tab"
                        href="#general"
                        role="tablist"
                      >
                        <i class="material-icons">info</i> Général
                      </a>
                    </li>
                    <li class="nav-item col-md-2">
                      <a
                        class="nav-link active"
                        data-toggle="tab"
                        href="#suivis"
                        role="tablist"
                      >
                        <i class="material-icons">event_available</i> Gestion
                        des saisies
                      </a>
                    </li>
                    <li class="nav-item col-md-2">
                      <a
                        class="nav-link"
                        data-toggle="tab"
                        href="#pilotage"
                        role="tablist"
                      >
                        <i class="material-icons">insert_chart</i> Pilotage
                      </a>
                    </li>
                  </ul>
                  <div class="tab-content tab-space tab-subcategories">
                    <div class="tab-pane" id="general">
                      <div class="card">
                        <div class="card-body">
                          <!-- Description du KPI -->
                          <div class="row col-md-12">
                            <span class="col-md-2">
                              <br />
                              <h4 class="font-weight-bold">Description :</h4>
                            </span>
                            <span class="col-md-10">
                              <h3>{{ indicateurDetail.description }}</h3>
                            </span>
                          </div>
                          <br />

                          <div class="row">
                            <!-- Propriétés du KPI -->
                            <div class="col-lg-7">
                              <div class="card border shadow">
                                <div
                                  class="card-header card-header-warning card-header-icon"
                                >
                                  <div class="card-icon">
                                    <i class="material-icons">settings</i>
                                  </div>
                                  <h4 class="card-title font-weight-bold">
                                    Propriétés de l'indicateur :
                                  </h4>
                                </div>
                                <div
                                  class="card-body"
                                  *ngIf="indicateurDetail.parametres"
                                >
                                  <h4 class="col-lg-12">
                                    <span class="font-weight-bold">
                                      Objectif :
                                    </span>
                                    {{ objectifIndicateur }}
                                  </h4>
                                  <h4 class="col-lg-12">
                                    <span class="font-weight-bold">
                                      Sous-objectif :
                                    </span>
                                    {{ sousObjectifIndicateur }}
                                  </h4>
                                  <h4 class="col-lg-12">
                                    <span class="font-weight-bold">
                                      Origine :
                                    </span>
                                    {{ origineIndicateur }}
                                  </h4>
                                  <h4 class="col-lg-12">
                                    <span class="font-weight-bold">
                                      Opération :
                                    </span>
                                    {{ operationIndicateurToUpdate }}
                                  </h4>
                                  <h4 class="col-lg-12">
                                    <span class="font-weight-bold">
                                      Unité :
                                    </span>
                                    {{ uniteIndicateur }}
                                  </h4>
                                  <h4 class="col-lg-12">
                                    <span class="font-weight-bold">
                                      Tendance :
                                    </span>
                                    {{ tendanceIndicateurToUpdate }}
                                  </h4>
                                  <h4 class="col-lg-12">
                                    <span class="font-weight-bold">
                                      Périodicité :
                                    </span>
                                    {{ periodiciteIndicateur }}
                                  </h4>
                                  <h4 class="col-lg-12">
                                    <span class="font-weight-bold">
                                      Type d'indicateur :
                                    </span>
                                    {{ typeIndicateur }}
                                  </h4>
                                </div>
                              </div>
                            </div>
                            <!-- Valeur cible et info de calculs -->
                            <div class="col-lg-5">
                              <div class="card border shadow">
                                <div
                                  class="card-header card-header-warning card-header-icon"
                                >
                                  <div class="card-icon">
                                    <i class="material-icons">flag</i>
                                  </div>
                                  <h4 class="card-title font-weight-bold">
                                    Valeur Cible :
                                  </h4>
                                </div>
                                <div class="card-body">
                                  <h3
                                    class="text-center text-primary font-weight-bold"
                                  >
                                    {{ indicateurDetail.valeur_cible }}
                                    {{ uniteIndicateur }}
                                  </h3>
                                  <!-- <h4 class="text-left">
                                    Objectif de suivi :
                                  </h4> -->
                                </div>
                              </div>
                              <div class="card border shadow">
                                <div
                                  class="card-header card-header-warning card-header-icon"
                                >
                                  <div class="card-icon">
                                    <i class="material-icons">functions</i>
                                  </div>
                                  <h4 class="card-title font-weight-bold">
                                    Informations de calcul :
                                  </h4>
                                </div>
                                <br />
                                <div class="card-body">
                                  <h5 class="text-left">
                                    <span class="font-weight-bold">
                                      Formule :
                                    </span>
                                    {{ indicateurDetail.formule_calcul }}
                                  </h5>
                                  <div class="card-collapse">
                                    <!-- <div
                                      class="card-header"
                                      role="tab"
                                      id="LoiComposition"
                                    > -->
                                    <h5 class="mb-0">
                                      <a
                                        data-toggle="collapse"
                                        href="#loiCompo"
                                        aria-expanded="false"
                                        aria-controls="loiCompo"
                                      >
                                        Loi de composition
                                        <i class="material-icons"
                                          >keyboard_arrow_down</i
                                        >
                                      </a>
                                    </h5>
                                    <!-- </div> -->
                                    <div
                                      id="loiCompo"
                                      class="collapse"
                                      role="tabpanel"
                                      aria-labelledby="LoiComposition"
                                      data-parent="#accordion"
                                    >
                                      <div class="card-body">
                                        {{ indicateurDetail.loi_composition }}
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                          <div class="row">
                            <!-- Proprétaire(s) -->
                            <div class="col-lg-4">
                              <div class="card border shadow">
                                <div
                                  class="card-header card-header-warning card-header-icon"
                                >
                                  <div class="card-icon">
                                    <i class="material-icons">person</i>
                                  </div>
                                  <h4 class="card-title font-weight-bold">
                                    Propriétaire(s)
                                  </h4>
                                </div>
                                <div class="card-body">
                                  <div class="row">
                                    <mat-list role="list">
                                      <mat-list-item
                                        role="listitem"
                                        *ngFor="
                                          let proprietaire of proprietaires
                                        "
                                      >
                                        {{ proprietaire.prenom }}
                                        {{ proprietaire.nom }}
                                      </mat-list-item>
                                    </mat-list>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <!-- Suppléant(s) -->
                            <div class="col-lg-4">
                              <div class="card border shadow">
                                <div
                                  class="card-header card-header-warning card-header-icon"
                                >
                                  <div class="card-icon">
                                    <i class="material-icons">contacts</i>
                                  </div>
                                  <h4 class="card-title font-weight-bold">
                                    Suppléant(s)
                                  </h4>
                                </div>
                                <div class="card-body">
                                  <div class="row">
                                    <mat-list role="list">
                                      <mat-list-item
                                        role="listitem"
                                        *ngFor="let suppleant of suppleants"
                                      >
                                        {{ suppleant.prenom }}
                                        {{ suppleant.nom }}
                                      </mat-list-item>
                                    </mat-list>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <!-- Analyste(s) -->
                            <div class="col-lg-4">
                              <div class="card border shadow">
                                <div
                                  class="card-header card-header-warning card-header-icon"
                                >
                                  <div class="card-icon">
                                    <i class="material-icons">policy</i>
                                  </div>
                                  <h4 class="card-title font-weight-bold">
                                    Analyste(s)
                                  </h4>
                                </div>
                                <div class="card-body">
                                  <div class="row">
                                    <mat-list role="list">
                                      <mat-list-item
                                        role="listitem"
                                        *ngFor="let analyste of analystes"
                                      >
                                        {{ analyste.prenom }}
                                        {{ analyste.nom }}
                                      </mat-list-item>
                                    </mat-list>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="tab-pane active" id="suivis">
                      <div class="card">
                        <div class="card-body">
                          <div class="col-md-4 ml-auto mr-auto mb-5">
                            <ng-multiselect-dropdown
                              [placeholder]="'Année de suivi'"
                              [settings]="anneedropdownSettings"
                              [data]="anneesToSelect"
                              [(ngModel)]="selectedAnnee"
                              (onSelect)="onAnneeSelect($event)"
                              required
                            >
                            </ng-multiselect-dropdown>
                          </div>

                          <div *ngIf="1 == 1" class="row">
                            <div class="col-md-10 mr-auto ml-auto">
                              <div class="nav-tabs-navigation">
                                <div class="nav-tabs-wrapper">
                                  <ul
                                    class="nav nav-tabs row"
                                    data-tabs="tabs"
                                  ></ul>
                                </div>
                              </div>

                              <div id="suivis" class="tab-pane active">
                                <table
                                  class="table table-striped table-no-bordered table-hover table-responsive-xl"
                                  style="width: 100%"
                                  tableLayout="fixed"
                                >
                                  <thead>
                                    <tr>
                                      <th class="text-left" style="width: 20%">
                                        Mois
                                      </th>
                                      <th
                                        class="text-center"
                                        style="width: 25%"
                                      >
                                        Objectif Périodique
                                      </th>
                                      <th
                                        class="text-center"
                                        style="width: 25%"
                                      >
                                        Valeur du suivi
                                      </th>
                                      <th
                                        class="disabled-sorting text-center"
                                        style="width: 15%"
                                      >
                                        Actions
                                      </th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="let saisie of saisies">
                                      <ng-container *ngIf="showSaisie(saisie)">
                                        <td class="text-left">
                                          {{ saisie.moisId }}
                                        </td>
                                        <td class="text-center">
                                          {{ saisie.objectifPeriodique }}
                                        </td>
                                        <td class="text-center">
                                          {{ saisie.valeur }}
                                        </td>

                                        <td class="text-center">
                                          <button
                                            class="btn btn-link btn-warning btn-just-icon edit"
                                            *ngIf="saisie.valeur"
                                            (click)="
                                              setSaisieToUpdate(
                                                saisie,
                                                'newValeur'
                                              )
                                            "
                                            data-toggle="modal"
                                            data-target="#saisieModal"
                                            title="Renseigner"
                                          >
                                            <i class="material-icons">{{
                                              indicateurDetail.arret ||
                                              rightToEdit == false
                                                ? "info"
                                                : "edit"
                                            }}</i>
                                          </button>
                                          <button
                                            [disabled]="
                                              indicateurDetail.arret ||
                                              rightToEdit == false
                                            "
                                            class="btn btn-link btn-warning btn-just-icon delete"
                                            (click)="
                                              setSaisieToUpdate(saisie, 'ND')
                                            "
                                            data-toggle="modal"
                                            data-target="#deleteSaisieModal"
                                            title="Supprimer"
                                          >
                                            <i class="material-icons">cancel</i>
                                          </button>
                                          <button
                                            [disabled]="
                                              indicateurDetail.arret ||
                                              rightToEdit == false
                                            "
                                            *ngIf="saisie.valeur != 'NA'"
                                            class="btn btn-link btn-danger btn-just-icon remove"
                                            (click)="
                                              setSaisieToUpdate(saisie, 'NA')
                                            "
                                            data-toggle="modal"
                                            data-target="#disableSaisieModal"
                                            title="Rendre inapplicable"
                                          >
                                            <i class="material-icons"
                                              >archive</i
                                            >
                                          </button>
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="tab-pane" id="pilotage">
                      <div class="card">
                        <div class="card-header">
                          <h4 class="card-title text-center text-primary">
                            Informations liées au pilotage
                          </h4>
                          <!-- <p class="card-category">More information here</p> -->
                        </div>
                        <div class="card-body text-center">
                          <br />
                          <br />
                          <h3>COMING SOON</h3>
                          <br />
                          <br />
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Classic Modal mensualiser objectif-->
  <div
    class="modal fade col-md-12"
    id="mensualiserObjectifModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="myModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-lg" style="z-index: 1041">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Mensualiser vos objectifs</h4>
          <button
            mat-button
            type="button"
            class="close"
            data-dismiss="modal"
            aria-hidden="true"
          >
            <i class="material-icons">clear</i>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group bmd-form-group is-filled">
            <form class="row" [formGroup]="mensualisationForm">
              <ng-container *ngFor="let saisie of saisies">
                <mat-form-field
                  *ngIf="saisie.moisId == 'janvier'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    formControlName="janvier"
                    name="janvier"
                    required
                    class="saisies"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'février'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="fevrier"
                    required
                    class="saisies"
                    formControlName="fevrier"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'mars'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="mars"
                    required
                    class="saisies"
                    formControlName="mars"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'avril'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="avril"
                    required
                    class="saisies"
                    formControlName="avril"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'mai'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="mai"
                    required
                    class="saisies"
                    formControlName="mai"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'juin'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="juin"
                    required
                    class="saisies"
                    formControlName="juin"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'juillet'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="juillet"
                    required
                    class="saisies"
                    formControlName="juillet"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'août'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="aout"
                    required
                    class="saisies"
                    formControlName="aout"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'septembre'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="septembre"
                    required
                    class="saisies"
                    formControlName="septembre"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'octobre'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="octobre"
                    required
                    class="saisies"
                    formControlName="octobre"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'novembre'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="novembre"
                    required
                    class="saisies"
                    formControlName="novembre"
                  />
                </mat-form-field>
                <mat-form-field
                  *ngIf="saisie.moisId == 'décembre'"
                  class="example-full-width col-md-4"
                >
                  <mat-label>{{ saisie.moisId }}</mat-label>
                  <input
                    matInput
                    type="number"
                    id="{{ saisie.id }}"
                    name="decembre"
                    required
                    class="saisies"
                    formControlName="decembre"
                  />
                </mat-form-field>
              </ng-container>
            </form>
          </div>
        </div>
        <div class="modal-footer">
          <button
            mat-raised-button
            type="button"
            class="btn"
            [disabled]="!mensualisationForm.valid"
            (click)="mensualiserObjectif(mensualisationForm.value)"
            data-dismiss="modal"
          >
            Valider
          </button>
          <button
            mat-raised-button
            type="button"
            class="btn btn-danger"
            data-dismiss="modal"
          >
            Annuler
          </button>
        </div>
      </div>
    </div>
  </div>
  <!--  End Modal mensualiser objectif-->

  <!-- Classic Modal AJOUT Suivis -->
  <div
    class="modal fade"
    id="saisieModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="myModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-lg" style="z-index: 1041">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Enregistrer ou modifier une saisie</h4>
          <button
            mat-button
            type="button"
            class="close"
            data-dismiss="modal"
            aria-hidden="true"
          >
            <i class="material-icons">clear</i>
          </button>
        </div>
        <div class="modal-body">
          <table
            class="table table-striped table-no-bordered table-hover table-responsive-xl"
            style="width: 100%"
            tableLayout="fixed"
            *ngIf="saisieToUpdate != undefined && saisieToUpdate.erqs"
          >
            <thead>
              <tr>
                <th class="text-left" style="width: 20%">Erq</th>

                <th class="disabled-sorting text-center" style="width: 15%">
                  Actions
                </th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let erq of saisieToUpdate.erqs">
                <td class="text-left" (click)="downloadErq(erq)">
                  {{ erq.fileOriginalname }}
                </td>

                <td class="text-center">
                  <button
                    [disabled]="indicateurDetail.arret || rightToEdit == false"
                    class="btn btn-link btn-warning btn-just-icon delete"
                    (click)="setErqToManage(erq)"
                    data-toggle="modal"
                    data-target="#deleteErqModal"
                    title="Supprimer"
                  >
                    <i class="material-icons">cancel</i>
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="form-group bmd-form-group is-filled">
            <form class="row" [formGroup]="suiviForm">
              <div class="col-md-12">
                <mat-form-field class="example-full-width">
                  <mat-label>Valeur mensuelle du KPI</mat-label>
                  <input
                    matInput
                    type="number"
                    name="valeur"
                    formControlName="valeur"
                    required
                    (blur)="
                      updateSaisieForm(
                        saisies,
                        saisieToUpdate,
                        operationIndicateurToUpdate,
                        tendanceIndicateurToUpdate
                      )
                    "
                    [readonly]="indicateurDetail.arret || rightToEdit == false"
                  />
                </mat-form-field>
              </div>
              <div class="col-md-12">
                <mat-form-field class="example-full-width">
                  <mat-label>Objectif Mensuel</mat-label>
                  <input
                    matInput
                    type="number"
                    name="objectifPeriodique"
                    formControlName="objectifPeriodique"
                    readonly
                    required
                    (blur)="
                      updateSaisieForm(
                        saisies,
                        saisieToUpdate,
                        operationIndicateurToUpdate,
                        tendanceIndicateurToUpdate
                      )
                    "
                  />
                </mat-form-field>
              </div>

              <div
                *ngIf="TAO != 'NA' && TAO != 'ND' && TAO < 100"
                class="col-md-12 text-center"
              >
                <button type="button" class="btn btn-danger">
                  Le TAO est de ( {{ TAO }} %)
                </button>
                <p>Merci de renseigner l'analyse et le plan d'action</p>
                <div class="col-md-12">
                  <mat-form-field class="example-full-width">
                    <textarea
                      matInput
                      type="text"
                      name="analyse"
                      placeholder="Veuillez ajouter une analyse"
                      formControlName="analyse"
                      [required]="
                        indicateurDetail.analyseRequise ||
                        indicateurDetail.analyseRequise == undefined
                      "
                      [readonly]="
                        indicateurDetail.arret || rightToEdit == false
                      "
                    ></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-12">
                  <mat-form-field class="example-full-width">
                    <textarea
                      matInput
                      type="text"
                      name="planAction"
                      placeholder="Veuillez ajouter un plan d'action"
                      formControlName="planAction"
                      [required]="
                        indicateurDetail.analyseRequise ||
                        indicateurDetail.analyseRequise == undefined
                      "
                      [readonly]="
                        indicateurDetail.arret || rightToEdit == false
                      "
                    ></textarea>
                  </mat-form-field>
                </div>
                <br /><br /><br /><br />

                <ng-multiselect-dropdown
                  [placeholder]="'Veuillez choisir le porteur du PA'"
                  [settings]="porteurdropdownSettings"
                  [data]="porteurs"
                  [formControl]="suiviForm.controls['porteur']"
                  [required]="
                    indicateurDetail.analyseRequise ||
                    indicateurDetail.analyseRequise == undefined
                  "
                  [disabled]="indicateurDetail.arret || rightToEdit == false"
                >
                </ng-multiselect-dropdown
                ><br /><br /><br /><br />
                <div class="row">
                  <div class="col-md-6">
                    <mat-form-field>
                      <mat-label
                        >Date de début de la mise en oueuvre du PA</mat-label
                      >
                      <input
                        matInput
                        [matDatepicker]="pickerDateDebut"
                        formControlName="dateDebut"
                        [required]="
                          indicateurDetail.analyseRequise ||
                          indicateurDetail.analyseRequise == undefined
                        "
                        [disabled]="
                          indicateurDetail.arret || rightToEdit == false
                        "
                      />
                      <mat-hint>DD/MM/YYYY</mat-hint>
                      <mat-datepicker-toggle
                        matIconSuffix
                        [for]="pickerDateDebut"
                      ></mat-datepicker-toggle>
                      <mat-datepicker #pickerDateDebut></mat-datepicker>
                    </mat-form-field>
                  </div>

                  <div class="col-md-6">
                    <mat-form-field>
                      <mat-label
                        >Date de fin de la mise en oueuvre du PA</mat-label
                      >
                      <input
                        matInput
                        [matDatepicker]="pickerDateFin"
                        formControlName="dateFin"
                        [required]="
                          indicateurDetail.analyseRequise ||
                          indicateurDetail.analyseRequise == undefined
                        "
                        [disabled]="
                          indicateurDetail.arret || rightToEdit == false
                        "
                      />
                      <mat-hint>DD/MM/YYYY</mat-hint>
                      <mat-datepicker-toggle
                        matIconSuffix
                        [for]="pickerDateFin"
                      ></mat-datepicker-toggle>
                      <mat-datepicker #pickerDateFin></mat-datepicker>
                    </mat-form-field>
                  </div>
                </div>
              </div>
              <div
                *ngIf="TAO != 'NA' && TAO != 'ND' && TAO >= 100"
                class="col-md-12 text-center"
              >
                <button type="button" class="btn btn-success">
                  Le TAO est de ( {{ TAO }} %)
                </button>
                <p>Vous pouvez rajouter un commentaire (facultatif)</p>
                <div class="col-md-12">
                  <mat-form-field class="example-full-width">
                    <textarea
                      matInput
                      type="text"
                      name="analyse"
                      placeholder="Ajouter un commentaire"
                      formControlName="analyse"
                      [readonly]="
                        indicateurDetail.arret || rightToEdit == false
                      "
                    ></textarea>
                  </mat-form-field>
                </div>
              </div>

              <div
                *ngIf="
                  TAO == 'NA' && this.tendanceIndicateurToUpdate == 'Aucune'
                "
                class="col-md-12 text-center"
              >
                <p>
                  <strong>
                    Aucune tendance n'a été définie pour cet indicateur, son TAO
                    est à <em>NA</em></strong
                  >
                </p>

                <p>Vous pouvez rajouter un commentaire (facultatif)</p>
                <div class="col-md-12">
                  <mat-form-field class="example-full-width">
                    <textarea
                      matInput
                      type="text"
                      name="analyse"
                      placeholder="Ajouter un commentaire"
                      formControlName="analyse"
                      [readonly]="
                        indicateurDetail.arret || rightToEdit == false
                      "
                    ></textarea>
                  </mat-form-field>
                </div>
              </div>
            </form>
          </div>
        </div>
        <div class="col-md-12">
          <div class="panel-wrapper" aria-expanded="true">
            <div class="panel-body">
              <form id="uploadForm">
                <label for="files">
                  Ajouter des ERQs (Seul les extentions XLSX, XSL, JPEG, JPG,
                  PNG, PDF, MSG, PPTX sont acceptées)
                </label>
                <input
                  type="file"
                  name="files"
                  multiple
                  id="files"
                  (change)="onFileChange($event)"
                  class="dropify-fr"
                  [disabled]="indicateurDetail.arret || rightToEdit == false"
                />
                <mat-error *ngIf="errors.length > 0">
                  <ul>
                    <li *ngFor="let error of errors">{{ error }}</li>
                  </ul>
                </mat-error>
              </form>
            </div>
          </div>
        </div>
        <div
          class="modal-footer justify-content-center"
          [hidden]="indicateurDetail.arret || rightToEdit == false"
        >
          <button
            mat-raised-button
            type="button"
            class="btn mr-5"
            style="background-color: green"
            [disabled]="!suiviForm.valid || errors.length > 0"
            (click)="updateSaisie(saisieToUpdate.id, suiviForm.value)"
            data-dismiss="modal"
          >
            Valider
          </button>
          <button
            mat-raised-button
            type="button"
            class="btn btn-danger"
            data-dismiss="modal"
          >
            Annuler
          </button>
        </div>
      </div>
    </div>
  </div>
  <!--  End Modal AJOUT Suivis-->

  <!-- Classic Modal delete Suivis -->
  <div
    class="modal fade col-md-12"
    id="deleteSaisieModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="myModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-md" style="z-index: 1041">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Supprimer la saisie</h4>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-12 text-center">
              <p>Voulez-vous supprimer la saisie pour cette période?</p>
            </div>
          </div>
        </div>
        <div class="modal-footer justify-content-center">
          <button
            mat-raised-button
            type="button"
            class="btn"
            (click)="updateSaisie(saisieToUpdate.id, { valeur: typeEdit })"
            data-dismiss="modal"
          >
            Confirmer
          </button>
          <button
            mat-raised-button
            type="button"
            class="btn btn-danger"
            data-dismiss="modal"
          >
            Annuler
          </button>
        </div>
      </div>
    </div>
  </div>
  <!--  End Modal delete Suivis-->

  <!-- Classic Modal delete Suivis -->
  <div
    class="modal fade col-md-12"
    id="deleteErqModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="myModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-md" style="z-index: 1041">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Supprimer l'ERQ</h4>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-12 text-center">
              <p>Voulez-vous supprimer l'ERQ ?</p>
            </div>
          </div>
        </div>
        <div class="modal-footer justify-content-center">
          <button
            mat-raised-button
            type="button"
            class="btn mr-5"
            (click)="deleteErq()"
            data-dismiss="modal"
          >
            Confirmer
          </button>
          <button
            mat-raised-button
            type="button"
            class="btn btn-danger"
            data-dismiss="modal"
          >
            Annuler
          </button>
        </div>
      </div>
    </div>
  </div>
  <!--  End Modal delete ERQ-->

  <!-- Classic Modal disable Suivis -->
  <div
    class="modal fade col-md-12"
    id="disableSaisieModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="myModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-md" style="z-index: 1041">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title">Rendre la saisie inapplicable</h4>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-12 text-center">
              <p>
                Voulez-vous rendre la saisie du suivi inapplicable pour cette
                période?
              </p>
            </div>
          </div>
        </div>
        <div class="modal-footer justify-content-center">
          <button
            mat-raised-button
            type="button"
            class="btn"
            (click)="updateSaisie(saisieToUpdate.id, { valeur: typeEdit })"
            data-dismiss="modal"
          >
            Confirmer
          </button>
          <button
            mat-raised-button
            type="button"
            class="btn btn-danger"
            data-dismiss="modal"
          >
            Annuler
          </button>
        </div>
      </div>
    </div>
  </div>
  <!--  End Modal disable Suivis-->
</div>
